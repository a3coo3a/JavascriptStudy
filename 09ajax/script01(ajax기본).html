<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <button type="button" onclick="ajax()">비동기요청</button>

  <script>
    function ajax(){
      // 1st
      //fetch("hi.txt").then(function(response){
      //  response.text().then(function(text){
      //    alert(text);
      //  })
      //})

      // 2nd
      // Promise는 fetch를 사용했을 때, 결과에 대한 상태 정보를 반환햊는 약속된 객체
      // - pending : 수행중
      // - fullfilled : 성공적 완료
      // - rejected : 실패
      //var result = fetch("hi.txt");    //  "서버에게 "  hi.txt 파일을 나에게 줘 라고 "요청"하는 것
      //console.log(result);
    
      // 3nd
      // 보통의 경우에는 요청받은 순서대로 처리되는데
      // ajax 다른 함수의 실행과 동시에 실행됩니다. (순서를 보장하지 않음)
      // 결과를 받아 오면 약속된 함수 안에 정의된 콜백 함수에 그 실행결과를 넣어줌.
      //var callback = function (){
      //  console.log("이게먼저 실행 될까요?");
      //}
      
      //fetch("hi.txt").then(callback);
      //console.log(1);
      //console.log(2);

      // 4nd
      /*  
      fetch("hi.txt").then(function(response){
        if(response.status != 200){
          alert("네트워크 상에 문제가 발생했습니다.");
          return;
        }
        console.log(response);
        // 응답 객체의 text() : 문자열의 형태로 결과를 바꿔서 then안에 콜백함수에 넣어줍니다
        response.text().then(function(text){
          console.log(text);
        })
      })
     */

     // 5nd
     // 응답객체 내용이 json형식이라면 json()을 이용해서 결과를 받아서 사용할 수 있다
     // json 형식에 따라 작성되어야 함.
     /*
    fetch("hi.json").then(function(response){
      if(response.status != 200){
        alert("네트워크 상에 문제가 발생했습니다");
      }else{
        response.json().then(function(data){
          //console.log(data);
          for(var k in data){
            console.log(k + " : " + data[k]);
            console.log(data[k]);
          }
        })
      }
    });
    */

    //6nd
    // 간단하게...
    
    fetch("hi.json")
      .then(function(response){
        return response.json();   // 패치에 결과가 리턴됨
      }).then(function(data){
        return data.user_id;
      }).then(function(data){
        console.log(data);
      })
      






    }
  </script>
</body>
</html>